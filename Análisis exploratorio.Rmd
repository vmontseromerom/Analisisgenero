---
title: "Análisis Exploratorio ENOE"
author: "Montserrat Romero"
date: "8/5/2022"
output: html_document
---
El objetivo del presente trabajo es realizar un análisis exploratorio con perspectiva de género utilizando información de la Encuesta Nacional de Ocupación y Empleo (ENOE), elaborada y publicada por el INEGI, para los años 2013 y 2018. Se considerara trabajar también con datos para el año 2021 para lograr observar sí existio alguna modificación en el comportamiento en las variables a analizar derivado del confinamiento por el virus Covid-19. 
El docuemnto que se tomará como base principal para explorar la ENOE en el presente software R sera: Escoto Ana R. (2021),¿cómo empezar a estudiar el mercado de trabajo en México?,UNAM,CDMX.

Antes de comenzar a trabajar es importante cargar nuestras paqueterias para ello haremos uso de la herramienta "pacman" la cual nos permite instalar simultaneamente paquetes.

```{r}

if (!require("pacman")) install.packages("pacman") 

pacman::p_load(tidyverse, haven, janitor, srvyr, RColorBrewer, wesanderson, sjlabelled)
```


En la página de la ENOE es posible encontrar microdatos para descargar y trabajar en diferentes formatos (.csv,.dta,.dbf y .sav) 
Trabajaremos en este ejercicio con la información en formato .dta

#Cargar la información para el primer trimestre del año 2013
```{r}
sdemt113	<- read_dta("C:/repos/Analisisgenero/2013trim1_dta/SDEMT113.dta")
coe1t113	<- read_dta("C:/repos/Analisisgenero/2013trim1_dta/COE1T113.dta")
coe2t113	<- read_dta("C:/repos/Analisisgenero/2013trim1_dta/COE2T113.dta")
hogt113 	<- read_dta("C:/repos/Analisisgenero/2013trim1_dta/HOGT113.dta")
vivt113		<- read_dta("C:/repos/Analisisgenero/2013trim1_dta/VIVT113.dta")

```

#Cargar la información para el primer trimestre del año 2018
```{r}
sdemt118	<- read_dta("C:/repos/Analisisgenero/2018trim1_dta/SDEMT118.dta")
coe1t118	<- read_dta("C:/repos/Analisisgenero/2018trim1_dta/COE1T118.dta")
coe2t118	<- read_dta("C:/repos/Analisisgenero/2018trim1_dta/COE2T118.dta")
hogt118 	<- read_dta("C:/repos/Analisisgenero/2018trim1_dta/HOGT118.dta")
vivt118		<- read_dta("C:/repos/Analisisgenero/2018trim1_dta/VIVT118.dta")

```

#Unificar las bases de la ENOE

Como podemos observar la ENOE se compone de 5 baterias de información la cual incluye datos referentes a :vivienda, hogares, sociodemografico, ocupación y empleo 1 y 2. Podemos realizar la unión utilizando diferentes procedimientos, en este trabajo moestramos una opción:

| Campo  | Descripción              |
|--------|--------------------------|
| CD_A   | Ciudad auto representada |
| ENT    | Entidad                  |
| CON    | Control                  |
| V_SEL  | Vivienda seleccionada    |
| N_HOG  | Número de hogar          |
| H_MUD  | Hogar mudado             |
| N_REN  | Número de renglón        |


#Creamos nuestros identificadores los cuales funcionara como llave para unir nuestras bases.

```{r}
idvivienda<-c("cd_a",	"ent",	"con",	"v_sel")
idhogar<-c("cd_a",	"ent",	"con",	"v_sel","n_hog",	"h_mud")
idpersona<-c("cd_a",	"ent",	"con",	"v_sel","n_hog",	"h_mud",	"n_ren")

```

La primer unión de bases que realizaremos seran "coe1t113" y "coe2t113" a partir del "idpersona"

```{r}
coet13 <-merge(coe1t113,coe2t113, by= idpersona)

```

Algunas variables se repetiran, sin embargo incluran la misma información por lo cual terminaran en .x o .y, podemos eliminar las variables duplicadas.

```{r}
coet13<-coet13	%>%select(-ends_with(".y"))%>% rename_at(.vars	= vars(ends_with(".x")),.funs	= funs(sub("[.]x$",	"",	.)))	

```

Seguiremos con nuestra unión incluyendo la información "sdemt113", es importante considerar que uniremos toda la información de las bases y posteriormente limpiaremos las variables duplicadas.

```{r}
sdemcoe13<-merge(sdemt113,coet13,	by=idpersona, all = TRUE)

sdemcoe13<-sdemcoe13	%>% select(-ends_with(".y"))	%>%  rename_at(.vars	= vars(ends_with(".x")),.funs	= funs(sub("[.]x$",	"",	.)))

```
Procederemos a unir las bases de "vivt113" y "hogt113".

```{r}
vivhog13<-merge(vivt113,	hogt113,	by=idvivienda)
vivhog13<-vivhog13	%>% select(-ends_with(".y"))	%>% rename_at(.vars	= vars(ends_with(".x")),.funs	= funs(sub("[.]x$",	"",	.)))

```
Concluimos uniendo todas las bases para tenercompleta nuestra información de la ENOE para el primer trimestre del año 2013.
```{r}

ENOET113<-merge(vivhog13,	sdemcoe13,	by=idhogar)
ENOET113<-ENOET113	%>% select(-ends_with(".y"))	%>%  rename_at(.vars	= vars(ends_with(".x")),.funs	= funs(sub("[.]x$",	"",	.)))

```

La metodología del INEGI para trabajar con la ENOE indica que la informción con la que se podra trabajar sera aquella que cumpla con el criterio de ser entrevistas validas "r_def=00" y no considerar la residencia "ausente" "c_res=2". 
```{r}
ENOET113<-ENOET113%>% filter(r_def==0)	%>% filter(c_res!=2)

```

Repetiremos el mismo procedimiento para obtener la base de datos de la ENOE para el primer trimestre del 2018
Una vez que tenemos completa nuestra base de datos con la que vamos a trabajar pordemos eliminar utilizando rm () las bases que utilizamos para realizar la unión.


